EXTRN CODE(DELAY)
EXTRN CODE(I2C_DEVICE_WRITE)
EXTRN CODE(I2C_DEVICE_READ)

MYSEG SEGMENT CODE
RSEG MYSEG 
DAT: DB 'A','B','C','D','E','F'

;EXTRN CODE(DELAY)
SW EQU P2.0

CSEG AT 0H

MOV P3,#0FH
;SJMP $

MOV R2,#06H
MOV DPTR,#DAT
MOV R1,#00H

L2:

ACALL I2C_DEVICE_WRITE

INC R1
INC DPL
DJNZ R2,L2


L1:


ACALL DELAY
ACALL DELAY

MOV R0,#30H
MOV R2,#06H
MOV R3,#00H

L3:
JNB SW,$
JB SW,$
ACALL I2C_DEVICE_READ

ACALL DELAY
;ACALL DELAY
;ACALL DELAY
;ACALL DELAY
;ACALL DELAY

INC R3
INC R0
DJNZ R2,L3


ACALL DELAY
ACALL DELAY

MOV P3,#0FH


;SJMP L1
SJMP $
END
